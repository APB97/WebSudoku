@typeparam T

@implements IDisposable

@inject StringLocalizer<T> Localization

@code {
    [CascadingParameter]
    public required MainLayout Layout { get; set; }

    [Parameter]
    public required RenderFragment<StringLocalizer<T>> ChildContent { get; set; }

    protected StringLocalizer<T> Loc => Localization;

    protected override bool ShouldRender()
    {
        return Loc.IsReady;
    }

    protected override async Task OnInitializedAsync()
    {
        Layout.OnStateChanging += LoadResourcesAsync;
        await Loc.InitializeAsync(Layout.Culture);
    }

    private async Task LoadResourcesAsync()
    {
        await Loc.InitializeAsync(Layout.Culture);
        StateHasChanged();
    }

    void IDisposable.Dispose()
    {
        Layout.OnStateChanging -= LoadResourcesAsync;
    }
}
